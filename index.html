<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Alister Agri Pro</title>
    
    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="manifest.json">
    
    <meta name="theme-color" content="#2e7d32">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
</head>
<body>

<div id="app-container">

    <!-- HEADER (Lebih Pendek & Bersih) -->
    <div class="topbar">
        <div style="display:flex; align-items:center; gap:10px; width:100%;">
            <!-- Logo & Judul -->
            <img src="logoalister.png" alt="Logo" class="topbar-logo">
            <h2 style="font-size:1.3rem; margin:0;">Alister Agri Pro</h2>
            
            <!-- Wallet -->
            <div style="margin-left:auto;" class="user-wallet">ğŸ’° <span id="wallet-balance">0</span></div>
        </div>
    </div>

    <!-- VIEW DASHBOARD -->
    <div id="view-dashboard" class="view-section active">
        <div class="weather-card">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <div>
                    <div style="font-size: 2rem; font-weight: bold;">Cerah</div>
                    <div style="font-size: 0.8rem; opacity: 0.9;">Cocok untuk penyiangan & pemupukan</div>
                </div>
                <div style="font-size: 3rem;">â˜€ï¸</div>
            </div>
        </div>
        <div class="stats-row">
            <div class="stat-card">
                <div class="stat-val" id="dash-fields">0</div>
                <div class="stat-lbl">Lahan Aktif</div>
            </div>
            <div class="stat-card">
                <div class="stat-val" id="dash-expense">Rp 0</div>
                <div class="stat-lbl">Total Biaya</div>
            </div>
            <div class="stat-card">
                <div class="stat-val" id="dash-harvests">0</div>
                <div class="stat-lbl">Total Panen</div>
            </div>
        </div>
        <div class="card">
            <div class="card-title">ğŸŒ± Lahan Aktif</div>
            <div id="dashboard-fields"></div>
        </div>
        <div class="card">
            <div class="card-title">ğŸ“ Aktivitas Terakhir</div>
            <div id="activity-feed"></div>
        </div>
    </div>

    <!-- VIEW LAHAN -->
    <div id="view-lahan" class="view-section">
        <div class="card">
            <button class="btn btn-primary" onclick="modal.open('modal-field')">â• Tambah Lahan Baru</button>
        </div>
        <div id="fields-list"></div>
    </div>

    <!-- VIEW KATALOG -->
    <div id="view-katalog" class="view-section">
        <input type="text" id="search-catalog" class="form-input" placeholder="ğŸ” Cari tanaman..." style="margin-bottom:15px;" onkeyup="catalog.render()">
        <div id="catalog-list"></div>
        <div class="fab" onclick="modal.open('modal-plant')">+</div>
    </div>

    <!-- VIEW ALAT -->
    <div id="view-alat" class="view-section">
        <div class="tool-selector">
            <div class="tool-chip active" onclick="tools.setTab(0)">Benih</div>
            <div class="tool-chip" onclick="tools.setTab(1)">Pupuk</div>
            <div class="tool-chip" onclick="tools.setTab(2)">Obat HPT</div>
            <div class="tool-chip" onclick="tools.setTab(3)">NPK Calculator</div>
        </div>
        <div id="tool-0" class="card">
            <h3>Kalkulator Kebutuhan Benih</h3>
            <div class="input-group">
                <label>Pilih Tanaman:</label>
                <select id="cb-t" class="form-input"></select>
            </div>
            <div class="input-group">
                <label>Luas Lahan (mÂ²):</label>
                <input type="number" id="cb-l" class="form-input" placeholder="Contoh: 1000">
            </div>
            <button class="btn btn-primary" onclick="tools.calcBenih()">Hitung Kebutuhan</button>
            <div id="res-benih" class="calc-result"></div>
        </div>
        <div id="tool-1" class="card" style="display:none;">
            <h3>Kalkulator Kebutuhan Pupuk</h3>
            <div class="input-group">
                <label>Pilih Tanaman:</label>
                <select id="cp-t" class="form-input"></select>
            </div>
            <div class="input-group">
                <label>Luas Lahan (mÂ²):</label>
                <input type="number" id="cp-l" class="form-input">
            </div>
            <button class="btn btn-primary" onclick="tools.calcPupuk()">Hitung Kebutuhan</button>
            <div id="res-pupuk" class="calc-result"></div>
        </div>
        <div id="tool-2" class="card" style="display:none;">
            <h3>Kalkulator Obat Hama</h3>
            <div class="input-group">
                <label>Volume Tangki (Liter):</label>
                <input type="number" id="ch-t" class="form-input" placeholder="Contoh: 15">
            </div>
            <div class="input-group">
                <label>Dosis Obat (ml/Liter air):</label>
                <input type="number" id="ch-d" class="form-input" placeholder="Contoh: 2">
            </div>
            <button class="btn btn-primary" onclick="tools.calcHPT()">Hitung Campuran</button>
            <div id="res-hpt" class="calc-result"></div>
        </div>
        <div id="tool-3" class="card" style="display:none;">
            <h3>Kalkulator NPK</h3>
            <div class="input-group">
                <label>Pilih Tanaman:</label>
                <select id="cn-t" class="form-input"></select>
            </div>
            <div class="input-group">
                <label>Luas Lahan (hektar):</label>
                <input type="number" id="cn-l" class="form-input" placeholder="Contoh: 1">
            </div>
            <button class="btn btn-primary" onclick="tools.calcNPK()">Hitung Kebutuhan NPK</button>
            <div id="res-npk" class="calc-result"></div>
        </div>
    </div>

    <!-- VIEW BLOG -->
    <div id="view-blog" class="view-section">
        <div class="card">
            <div class="blog-header">
                <div class="blog-header-text">
                    <h3 class="blog-title">ğŸ“° Artikel Alister Agri</h3>
                    <p class="blog-subtitle">Wawasan terbaru dari Alister Agri </p>
                </div>
                <a href="https://alister10.blogspot.com" target="_blank" class="btn btn-visit">
                    Kunjungi Blog Resmi <span>&rarr;</span>
                </a>
            </div>
            <div id="blog-loading" class="blog-loading hidden">
                <div class="spinner"></div>
                <p>Memuat artikel terbaru...</p>
            </div>
            <div id="blog-container" class="blog-grid"></div>
            <div id="blog-error" class="blog-error hidden">
                <p>Gagal memuat artikel. Periksa koneksi internet Anda.</p>
            </div>
        </div>
    </div>

    <!-- VIEW PENGATURAN -->
    <div id="view-pengaturan" class="view-section">
        <div class="card">
            <div class="card-title">âš™ï¸ Pengaturan Aplikasi</div>
            
            <!-- URL Blog -->
            <div class="list-row">
                <div class="icon-box" style="background:rgba(41, 128, 185, 0.1);">ğŸŒ</div>
                <div class="text-box">
                    <div class="title">URL Feed Blog</div>
                    <div class="sub">Sumber artikel berita</div>
                </div>
            </div>
            <div style="padding: 0 10px 10px 10px;">
                <input type="text" id="setting-blog-url" class="form-input" placeholder="https://alister10.blogspot.com/feeds/posts/default">
            </div>

            <div class="list-row">
                <div class="icon-box" style="background:rgba(155, 89, 182, 0.1);">ğŸ”</div>
                <div class="text-box">
                    <div class="title">Filter Kata Kunci</div>
                    <div class="sub">Hanya tampilkan artikel yang relevan</div>
                </div>
            </div>
            <div style="padding: 0 10px 15px 10px;">
                <textarea id="setting-blog-keywords" class="form-input" rows="3" placeholder="teknik, sipil, proyek, jembatan"></textarea>
            </div>

            <div class="list-row">
                <div class="icon-box">ğŸŒ™</div>
                <div class="text-box">
                    <div class="title">Tema Aplikasi</div>
                    <div class="sub">Ganti tampilan gelap/terang</div>
                </div>
                <button class="action-btn" onclick="app.toggleTheme()">Ganti Tema</button>
            </div>
            
            <div class="list-row">
                <div class="icon-box">ğŸ’¾</div>
                <div class="text-box">
                    <div class="title">Backup Data</div>
                    <div class="sub">Simpan data ke file JSON</div>
                </div>
                <button class="action-btn" onclick="dataMgr.backup()">Download</button>
            </div>
            
            <div class="list-row">
                <div class="icon-box">ğŸ“‚</div>
                <div class="text-box">
                    <div class="title">Restore Data</div>
                    <div class="sub">Kembalikan data dari file</div>
                </div>
                <input type="file" id="restore-file" accept=".json" style="display:none" onchange="dataMgr.restore(this)">
                <button class="action-btn" onclick="document.getElementById('restore-file').click()">Upload</button>
            </div>

            <div class="list-row" style="margin-top:15px;">
                <div class="icon-box" style="background:rgba(231, 76, 60, 0.1);">âš ï¸</div>
                <div class="text-box">
                    <div class="title" style="color:var(--danger)">Reset Aplikasi</div>
                    <div class="sub">Hapus semua data dan reset ke default</div>
                </div>
                <button class="action-btn" style="color:var(--danger)" onclick="app.resetApp()">Reset</button>
            </div>
        </div>
    </div>

</div>

<!-- MODALS -->
<div id="modal-field" class="modal">
    <div class="modal-box">
        <h3>ğŸ“ Tambah Lahan Baru</h3>
        <div class="input-group"><label>Nama Lahan</label><input type="text" id="f-name" class="form-input" placeholder="Blok A Utama"></div>
        <div class="input-group"><label>Pilih Tanaman</label><select id="f-plant" class="form-input"></select></div>
        <div class="input-group"><label>Tanggal Tanam</label><input type="date" id="f-date" class="form-input"></div>
        <div class="input-group"><label>Luas (mÂ²)</label><input type="number" id="f-area" class="form-input" placeholder="1000"></div>
        <div class="input-group"><label>Jenis Biaya</label><select id="f-type" class="form-input"><option value="seed">Bibit & Tanam</option><option value="fert">Pupuk & Obat</option><option value="labor">Gaji Tenaga</option><option value="other">Lain-lain</option></select></div>
        <div class="input-group"><label>Biaya Awal (Rp)</label><input type="number" id="f-cost" class="form-input" placeholder="500000"></div>
        <button class="btn btn-primary" onclick="app.addField()">Simpan Lahan</button>
        <button class="btn btn-outline" style="margin-top:10px;" onclick="modal.close()">Batal</button>
    </div>
</div>

<div id="modal-detail" class="modal">
    <div class="modal-box">
        <div id="detail-header"></div>
        <div style="margin: 15px 0; padding:10px; background:var(--glass); border-radius:10px;">
            <h4 style="margin-bottom:10px;">ğŸ“… Jadwal Tanam</h4>
            <div id="d-timeline" class="timeline"></div>
        </div>
        <div style="margin: 15px 0; padding:10px; background:var(--glass); border-radius:10px;">
            <h4 style="margin-bottom:10px;">ğŸ“‹ Daftar Tugas</h4>
            <div id="task-list"></div>
            <div style="display:flex; gap:5px; margin-top:10px;">
                <input type="text" id="new-task-input" class="form-input" placeholder="Tambah tugas..." style="font-size:0.8rem; padding:8px;">
                <button class="btn btn-primary" style="width:auto; padding:8px 12px;" onclick="app.addTask()">â•</button>
            </div>
        </div>
        <button class="btn btn-primary" onclick="app.initHarvest()">ğŸŒ½ Lakukan Panen</button>
        <button class="btn btn-outline" style="margin-top:10px;" onclick="modal.close()">Tutup</button>
    </div>
</div>

<div id="modal-plant-info" class="modal">
    <div class="modal-box">
        <h3 id="pi-name">Nama Tanaman</h3>
        <p id="pi-desc" style="color:var(--text-muted); font-size:0.9rem; margin-bottom:15px;"></p>
        <div id="pi-timeline" style="margin-top:15px;"></div>
        <button class="btn btn-primary" style="margin-top:15px;" onclick="modal.close()">Tutup</button>
    </div>
</div>

<div id="modal-plant" class="modal">
    <div class="modal-box">
        <h3>ğŸŒ± Tambah Tanaman Baru</h3>
        <div class="input-group"><label>Nama Tanaman</label><input type="text" id="p-name" class="form-input" placeholder="Contoh: Padi Ciherang"></div>
        <div class="input-group"><label>Harga Jual (per Kg)</label><input type="number" id="p-price" class="form-input" placeholder="10000"></div>
        <div class="input-group"><label>Hari Panen (HST)</label><input type="number" id="p-days" class="form-input" placeholder="90"></div>
        <div class="input-group"><label>Kebutuhan Benih per mÂ²</label><input type="number" id="p-seeds" class="form-input" placeholder="0.2" step="0.01"></div>
        <div class="input-group"><label>Kategori</label><select id="p-cat" class="form-input"><option value="Pangan">Pangan</option><option value="Sayur">Sayur</option><option value="Buah">Buah</option><option value="Pohon">Pohon</option></select></div>
        <button class="btn btn-primary" onclick="app.addPlant()">Simpan Tanaman</button>
        <button class="btn btn-outline" style="margin-top:10px;" onclick="modal.close()">Batal</button>
    </div>
</div>

<!-- FOOTER ALISTER MEDIA -->
<footer class="footer-horizontal">
  <div class="footer-content">
    <span class="footer-copy">
      Â© 2026 All Rights Reserved. Design by Alister Media.
    </span>
  </div>
</footer>

<!-- BOTTOM NAVIGATION (BARU) -->
<nav class="bottom-nav">
    <button class="nav-item active" onclick="nav.to('dashboard')" id="nav-dashboard">
        <span class="nav-icon">ğŸ </span>
        <span class="nav-label">Home</span>
    </button>
    <button class="nav-item" onclick="nav.to('lahan')" id="nav-lahan">
        <span class="nav-icon">ğŸŒ±</span>
        <span class="nav-label">Lahan</span>
    </button>
    <button class="nav-item" onclick="nav.to('katalog')" id="nav-katalog">
        <span class="nav-icon">ğŸ“–</span>
        <span class="nav-label">Katalog</span>
    </button>
    <button class="nav-item" onclick="nav.to('alat')" id="nav-alat">
        <span class="nav-icon">âš’ï¸</span>
        <span class="nav-label">Alat</span>
    </button>
    <button class="nav-item" onclick="nav.to('blog')" id="nav-blog">
        <span class="nav-icon">ğŸ“°</span>
        <span class="nav-label">Blog</span>
    </button>
    <button class="nav-item" onclick="nav.to('pengaturan')" id="nav-pengaturan">
        <span class="nav-icon">âš™ï¸</span>
        <span class="nav-label">Menu</span>
    </button>
</nav>

<script src="script.js"></script>
<script>
    if ('serviceWorker' in navigator) {
        window.addEventListener('load', function() {
            navigator.serviceWorker.register('sw.js').then(function(registration) {
                console.log('ServiceWorker registration successful');
            }, function(err) {
                console.log('ServiceWorker registration failed', err);
            });
        });
    }
</script>
</body>
</html>
